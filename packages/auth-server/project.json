{
  "name": "auth-server",
  "tags": ["type:app"],
  "targets": {
    "dev": {
      "executor": "nx:run-commands",
      "options": {
        "cwd": "packages/auth-server",
        "commands": ["pnpm run copy:snarkjs && PORT=3002 nuxt dev", "pnpm nx run auth-server-api:dev"],
        "parallel": true
      },
      "dependsOn": ["^build", "demo-app:deploy-contracts-erc4337"]
    },
    "dev:no-deploy": {
      "executor": "nx:run-commands",
      "options": {
        "cwd": "packages/auth-server",
        "command": "pnpm run copy:snarkjs && PORT=3002 nuxt dev"
      },
      "dependsOn": ["^build"]
    },
    "dev:all": {
      "executor": "nx:run-commands",
      "options": {
        "cwd": "packages/auth-server",
        "commands": ["pnpm nx run auth-server:dev ", "pnpm nx run zksync-sso-oidc-server:dev:all"],
        "parallel": true
      }
    },
    "build": {
      "executor": "nx:run-commands",
      "options": {
        "cwd": "packages/auth-server",
        "commands": [{ "command": "pnpm nuxt generate" }]
      },
      "inputs": ["default", "{projectRoot}/scripts/copy-snarkjs.mjs"],
      "outputs": ["{projectRoot}/dist"],
      "dependsOn": ["copy-snarkjs", "^build"]
    },
    "copy-snarkjs": {
      "executor": "nx:run-commands",
      "options": {
        "cwd": "packages/auth-server",
        "command": "pnpm run copy:snarkjs"
      }
    },
    "build:local": {
      "executor": "nx:run-commands",
      "options": {
        "cwd": "packages/auth-server",
        "command": "pnpm nuxt generate --envName local"
      },
      "dependsOn": ["copy-snarkjs", "^build"]
    },
    "preview": {
      "executor": "nx:run-commands",
      "options": {
        "cwd": "packages/auth-server",
        "commands": [
          {
            "command": "NUXT_PUBLIC_AUTH_SERVER_API_URL=http://localhost:3004 PORT=3002 pnpm nuxt preview",
            "prefix": "Auth-Frontend:"
          },
          {
            "command": "PORT=3004 pnpm nx run auth-server-api:dev",
            "prefix": "Auth-API:"
          }
        ],
        "parallel": true
      },
      "dependsOn": ["build:local", "^build"]
    },
    "deploy": {
      "executor": "nx:run-commands",
      "options": {
        "cwd": "packages/auth-server",
        "command": "firebase deploy --only hosting:zksync-auth-server-staging --project zksync-auth-server-staging"
      },
      "dependsOn": ["build"]
    },
    "deploy:preview": {
      "executor": "nx:run-commands",
      "options": {
        "cwd": "packages/auth-server",
        "command": "firebase hosting:channel:deploy --only zksync-auth-server-staging --project zksync-auth-server-staging"
      },
      "dependsOn": ["build"]
    }
  }
}
